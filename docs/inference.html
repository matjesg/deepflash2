---

title: Inference


keywords: fastai
sidebar: home_sidebar

summary: "Classes for inference with model ensembles using Torchscript."
description: "Classes for inference with model ensembles using Torchscript."
nb_path: "nbs/04_inference.ipynb"
---
<!--

#################################################
### THIS FILE WAS AUTOGENERATED! DO NOT EDIT! ###
#################################################
# file to edit: nbs/04_inference.ipynb
# command to build the docs after a change: nbdev_build_docs

-->

<div class="container" id="notebook-container">
        
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Helper-functions">Helper functions<a class="anchor-link" href="#Helper-functions"> </a></h2><p>Gaussian weighting for merging different predictions.</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="ScriptFunction object at 0x7fe727b7e8b0>" class="doc_header"><code>ScriptFunction object at 0x7fe727b7e8b0></code><a href="" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>ScriptFunction object at 0x7fe727b7e8b0></code>()</p>
</blockquote>
<p>Returns a Gaussian window</p>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="ScriptFunction object at 0x7fe727b7e860>" class="doc_header"><code>ScriptFunction object at 0x7fe727b7e860></code><a href="" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>ScriptFunction object at 0x7fe727b7e860></code>()</p>
</blockquote>
<p>Returns a 2D Gaussian kernel tensor.</p>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">gw</span> <span class="o">=</span> <span class="n">gaussian_kernel_2d</span><span class="p">((</span><span class="mi">256</span><span class="p">,</span><span class="mi">256</span><span class="p">),</span> <span class="n">sigma_scale</span><span class="o">=</span><span class="mi">1</span><span class="o">/</span><span class="mi">8</span><span class="p">)</span>
<span class="n">test_eq</span><span class="p">(</span><span class="n">gw</span><span class="o">.</span><span class="n">max</span><span class="p">(),</span> <span class="mi">1</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">gw</span><span class="p">);</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_png output_subarea ">
<img src="data:image/png;base64,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
"
>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Calculation of epistemic and aleatoric uncertainy</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="ScriptFunction object at 0x7fe727b7bc70>" class="doc_header"><code>ScriptFunction object at 0x7fe727b7bc70></code><a href="" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>ScriptFunction object at 0x7fe727b7bc70></code>()</p>
</blockquote>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="ScriptFunction object at 0x7fe727b7b8b0>" class="doc_header"><code>ScriptFunction object at 0x7fe727b7b8b0></code><a href="" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>ScriptFunction object at 0x7fe727b7b8b0></code>()</p>
</blockquote>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="ScriptFunction object at 0x7fe727b7bd10>" class="doc_header"><code>ScriptFunction object at 0x7fe727b7bd10></code><a href="" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>ScriptFunction object at 0x7fe727b7bd10></code>()</p>
</blockquote>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Tiling">Tiling<a class="anchor-link" href="#Tiling"> </a></h2><p>Functions and classes for tiling (slicing) images</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="get_in_slices_1d" class="doc_header"><code>get_in_slices_1d</code><a href="https://github.com/matjesg/deepflash2/tree/master/deepflash2/inference.py#L61" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>get_in_slices_1d</code>(<strong><code>center</code></strong>:<code>Tensor</code>, <strong><code>len_x</code></strong>:<code>int</code>, <strong><code>len_tile</code></strong>:<code>int</code>)</p>
</blockquote>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="get_out_slices_1d" class="doc_header"><code>get_out_slices_1d</code><a href="https://github.com/matjesg/deepflash2/tree/master/deepflash2/inference.py#L67" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>get_out_slices_1d</code>(<strong><code>center</code></strong>:<code>Tensor</code>, <strong><code>len_x</code></strong>:<code>int</code>, <strong><code>len_tile</code></strong>:<code>int</code>)</p>
</blockquote>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h2 id="TileModule" class="doc_header"><code>class</code> <code>TileModule</code><a href="https://github.com/matjesg/deepflash2/tree/master/deepflash2/inference.py#L74" class="source_link" style="float:right">[source]</a></h2><blockquote><p><code>TileModule</code>(<strong><code>tile_shape</code></strong>=<em><code>(512, 512)</code></em>, <strong><code>scale</code></strong>:<code>float</code>=<em><code>1.0</code></em>, <strong><code>border_padding_factor</code></strong>:<code>float</code>=<em><code>0.25</code></em>, <strong><code>max_tile_shift</code></strong>:<code>float</code>=<em><code>0.5</code></em>) :: <code>Module</code></p>
</blockquote>
<p>Class for tiling data.</p>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">ts</span> <span class="o">=</span> <span class="mi">540</span>
<span class="n">os</span> <span class="o">=</span> <span class="n">ts</span><span class="o">/</span><span class="mi">2</span>

<span class="n">t</span> <span class="o">=</span> <span class="n">TileModule</span><span class="p">(</span><span class="n">tile_shape</span><span class="o">=</span><span class="p">(</span><span class="n">ts</span><span class="p">,</span> <span class="n">ts</span><span class="p">))</span>
<span class="n">inp</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">from_numpy</span><span class="p">(</span><span class="n">image</span><span class="p">)</span><span class="o">.</span><span class="n">float</span><span class="p">()</span><span class="o">.</span><span class="n">unsqueeze_</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
<span class="n">out</span> <span class="o">=</span> <span class="n">t</span><span class="p">(</span><span class="n">inp</span><span class="p">,</span> <span class="p">(</span><span class="n">os</span><span class="p">,</span><span class="n">os</span><span class="p">))[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">]</span>
<span class="n">test_close</span><span class="p">(</span><span class="n">out</span><span class="p">,</span><span class="n">image</span><span class="p">,</span> <span class="n">eps</span><span class="o">=</span><span class="mf">1e-04</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">TS</span> <span class="o">=</span> <span class="p">[</span><span class="mi">256</span><span class="p">,</span> <span class="mi">512</span><span class="p">,</span> <span class="mi">1024</span><span class="p">]</span>
<span class="n">SCALES</span> <span class="o">=</span> <span class="p">[</span><span class="mf">0.5</span><span class="p">,</span> <span class="mf">1.</span><span class="p">,</span> <span class="mf">2.</span><span class="p">]</span>
<span class="n">SHIFTS</span> <span class="o">=</span> <span class="p">[</span><span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.9</span><span class="p">,</span> <span class="mf">1.</span><span class="p">]</span>
<span class="n">BPFACTORS</span> <span class="o">=</span> <span class="p">[</span><span class="mf">0.25</span><span class="p">,</span> <span class="mf">0.1</span><span class="p">,</span> <span class="mf">0.</span><span class="p">]</span>
<span class="n">inp</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">from_numpy</span><span class="p">(</span><span class="n">image</span><span class="p">)</span><span class="o">.</span><span class="n">float</span><span class="p">()</span><span class="o">.</span><span class="n">unsqueeze_</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>

<span class="k">for</span> <span class="n">ts</span> <span class="ow">in</span> <span class="n">TS</span><span class="p">:</span>
    <span class="k">for</span> <span class="n">scale</span> <span class="ow">in</span> <span class="n">SCALES</span><span class="p">:</span>
        <span class="k">for</span> <span class="n">max_tile_shift</span> <span class="ow">in</span> <span class="n">SHIFTS</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">border_padding_factor</span> <span class="ow">in</span> <span class="n">BPFACTORS</span><span class="p">:</span>
                <span class="n">t</span> <span class="o">=</span> <span class="n">TileModule</span><span class="p">(</span><span class="n">tile_shape</span><span class="o">=</span><span class="p">(</span><span class="n">ts</span><span class="p">,</span> <span class="n">ts</span><span class="p">),</span> <span class="n">scale</span><span class="o">=</span><span class="n">scale</span><span class="p">,</span> <span class="n">max_tile_shift</span><span class="o">=</span><span class="n">max_tile_shift</span><span class="p">,</span> <span class="n">border_padding_factor</span><span class="o">=</span><span class="n">border_padding_factor</span><span class="p">)</span>
                <span class="n">out</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="o">*</span><span class="p">[</span><span class="nb">int</span><span class="p">(</span><span class="n">x</span><span class="o">/</span><span class="n">t</span><span class="o">.</span><span class="n">scale</span><span class="p">)</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">inp</span><span class="o">.</span><span class="n">shape</span><span class="p">[:</span><span class="mi">2</span><span class="p">]])</span><span class="o">.</span><span class="n">unsqueeze_</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
                <span class="n">in_slices</span><span class="p">,</span> <span class="n">out_slices</span><span class="p">,</span> <span class="n">center_points</span> <span class="o">=</span> <span class="n">t</span><span class="o">.</span><span class="n">get_slices_and_centers</span><span class="p">(</span><span class="n">inp</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
                <span class="k">assert</span> <span class="nb">len</span><span class="p">(</span><span class="n">center_points</span><span class="p">)</span><span class="o">!=</span><span class="mi">0</span>
                <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">cp</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">center_points</span><span class="p">):</span>
                    <span class="n">ix0</span><span class="p">,</span> <span class="n">ix1</span><span class="p">,</span> <span class="n">iy0</span><span class="p">,</span> <span class="n">iy1</span> <span class="o">=</span> <span class="n">in_slices</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">][</span><span class="n">i</span><span class="p">],</span> <span class="n">in_slices</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">1</span><span class="p">][</span><span class="n">i</span><span class="p">],</span> <span class="n">in_slices</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="mi">0</span><span class="p">][</span><span class="n">i</span><span class="p">],</span> <span class="n">in_slices</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="mi">1</span><span class="p">][</span><span class="n">i</span><span class="p">]</span>
                    <span class="n">ox0</span><span class="p">,</span> <span class="n">ox1</span><span class="p">,</span> <span class="n">oy0</span><span class="p">,</span> <span class="n">oy1</span> <span class="o">=</span> <span class="n">out_slices</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">][</span><span class="n">i</span><span class="p">],</span> <span class="n">out_slices</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">1</span><span class="p">][</span><span class="n">i</span><span class="p">],</span> <span class="n">out_slices</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="mi">0</span><span class="p">][</span><span class="n">i</span><span class="p">],</span> <span class="n">out_slices</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="mi">1</span><span class="p">][</span><span class="n">i</span><span class="p">]</span>
                    <span class="k">assert</span> <span class="p">(</span><span class="n">ix1</span><span class="o">-</span><span class="n">ix0</span><span class="p">)</span> <span class="o">==</span> <span class="p">(</span><span class="n">ox1</span><span class="o">-</span><span class="n">ox0</span><span class="p">),</span> <span class="s1">&#39;Input/Output slices do not match&#39;</span>
                    <span class="k">assert</span> <span class="p">(</span><span class="n">iy1</span><span class="o">-</span><span class="n">iy0</span><span class="p">)</span> <span class="o">==</span> <span class="p">(</span><span class="n">oy1</span><span class="o">-</span><span class="n">oy0</span><span class="p">),</span> <span class="s1">&#39;Input/Output slices do not match&#39;</span>
                    <span class="n">tile</span> <span class="o">=</span> <span class="n">t</span><span class="p">(</span><span class="n">inp</span><span class="p">,</span> <span class="n">cp</span><span class="p">)</span>
                    <span class="n">out</span><span class="p">[</span><span class="n">ox0</span><span class="p">:</span><span class="n">ox1</span><span class="p">,</span> <span class="n">oy0</span><span class="p">:</span><span class="n">oy1</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span> <span class="o">+=</span> <span class="n">tile</span><span class="p">[</span><span class="mi">0</span> <span class="p">,</span><span class="mi">0</span><span class="p">,</span> <span class="n">ix0</span><span class="p">:</span><span class="n">ix1</span><span class="p">,</span> <span class="n">iy0</span><span class="p">:</span><span class="n">iy1</span><span class="p">]</span>
                    <span class="c1">#plt.imshow(out)</span>
                    <span class="c1">#plt.show()</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">if</span> <span class="n">torch</span><span class="o">.</span><span class="n">__version__</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;.&quot;</span><span class="p">)</span> <span class="o">&gt;=</span> <span class="p">[</span><span class="s2">&quot;1&quot;</span><span class="p">,</span> <span class="s2">&quot;12&quot;</span><span class="p">,</span> <span class="s2">&quot;0&quot;</span><span class="p">]:</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">torch</span><span class="o">.</span><span class="n">__version__</span><span class="p">)</span>
    <span class="n">t_scripted</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">jit</span><span class="o">.</span><span class="n">script</span><span class="p">(</span><span class="n">t</span><span class="p">)</span>
    <span class="n">ost</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">tensor</span><span class="p">(</span><span class="n">os</span><span class="p">)</span>
    <span class="n">path</span> <span class="o">=</span> <span class="n">Path</span><span class="p">(</span><span class="s1">&#39;TileModule.onnx&#39;</span><span class="p">)</span>
    <span class="n">_</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">onnx</span><span class="o">.</span><span class="n">export</span><span class="p">(</span><span class="n">t_scripted</span><span class="p">,</span> <span class="p">(</span><span class="n">inp</span><span class="p">,</span> <span class="n">torch</span><span class="o">.</span><span class="n">tensor</span><span class="p">([</span><span class="n">ost</span><span class="p">,</span> <span class="n">ost</span><span class="p">])),</span> <span class="n">path</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">opset_version</span><span class="o">=</span><span class="mi">16</span><span class="p">)</span>
    <span class="n">path</span><span class="o">.</span><span class="n">unlink</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Inference-Ensemble">Inference Ensemble<a class="anchor-link" href="#Inference-Ensemble"> </a></h2><p>Scripable module for inference with multiple models</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h2 id="InferenceEnsemble" class="doc_header"><code>class</code> <code>InferenceEnsemble</code><a href="https://github.com/matjesg/deepflash2/tree/master/deepflash2/inference.py#L143" class="source_link" style="float:right">[source]</a></h2><blockquote><p><code>InferenceEnsemble</code>(<strong><code>models</code></strong>:<code>List</code>[<code>Module</code>], <strong><code>num_classes</code></strong>:<code>int</code>, <strong><code>in_channels</code></strong>:<code>int</code>, <strong><code>channel_means</code></strong>:<code>List</code>[<code>float</code>], <strong><code>channel_stds</code></strong>:<code>List</code>[<code>float</code>], <strong><code>tile_shape</code></strong>:<code>Tuple</code>[<code>int</code>, <code>int</code>]=<em><code>(512, 512)</code></em>, <strong><code>use_gaussian</code></strong>:<code>bool</code>=<em><code>True</code></em>, <strong><code>gaussian_kernel_sigma_scale</code></strong>:<code>float</code>=<em><code>0.125</code></em>, <strong><code>use_tta</code></strong>:<code>bool</code>=<em><code>True</code></em>, <strong><code>border_padding_factor</code></strong>:<code>float</code>=<em><code>0.25</code></em>, <strong><code>max_tile_shift</code></strong>:<code>float</code>=<em><code>0.9</code></em>, <strong><code>scale</code></strong>:<code>float</code>=<em><code>1.0</code></em>, <strong><code>device</code></strong>:<code>str</code>=<em><code>'cpu'</code></em>) :: <code>Module</code></p>
</blockquote>
<p>Class for model ensemble inference</p>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">class</span> <span class="nc">DummyModule</span><span class="p">(</span><span class="n">torch</span><span class="o">.</span><span class="n">nn</span><span class="o">.</span><span class="n">Module</span><span class="p">):</span>
    <span class="s1">&#39;Dummy Module for testing&#39;</span>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">num_classes</span><span class="o">=</span><span class="mi">2</span><span class="p">):</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">num_classes</span> <span class="o">=</span> <span class="n">num_classes</span>
    
    <span class="k">def</span> <span class="nf">forward</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">x</span><span class="p">[:,:</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">repeat</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">num_classes</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">CHANNELS</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">3</span><span class="p">]</span>
<span class="n">NUM_CLASSES</span> <span class="o">=</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">5</span><span class="p">]</span>
<span class="n">SCALES</span> <span class="o">=</span> <span class="p">[</span><span class="mf">0.5</span><span class="p">,</span> <span class="mf">1.</span><span class="p">,</span> <span class="mf">4.</span><span class="p">]</span>
<span class="n">IMG_SHAPES</span> <span class="o">=</span> <span class="p">[</span><span class="mi">512</span><span class="p">]</span><span class="c1">#[256, 512, 1024]</span>

<span class="k">for</span> <span class="n">ch</span> <span class="ow">in</span> <span class="n">CHANNELS</span><span class="p">:</span>
    <span class="n">channel_means</span> <span class="o">=</span> <span class="p">[</span><span class="mf">0.</span><span class="p">]</span><span class="o">*</span><span class="n">ch</span>
    <span class="n">channel_stds</span> <span class="o">=</span> <span class="p">[</span><span class="mf">1.</span><span class="p">]</span><span class="o">*</span><span class="n">ch</span>
    <span class="k">for</span> <span class="n">num_classes</span> <span class="ow">in</span> <span class="n">NUM_CLASSES</span><span class="p">:</span>
        <span class="n">models</span> <span class="o">=</span> <span class="p">[</span><span class="n">DummyModule</span><span class="p">(</span><span class="n">num_classes</span><span class="o">=</span><span class="n">num_classes</span><span class="p">)</span> <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">2</span><span class="p">)]</span>
        <span class="k">for</span> <span class="n">sx</span> <span class="ow">in</span> <span class="n">IMG_SHAPES</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">sy</span> <span class="ow">in</span> <span class="n">IMG_SHAPES</span><span class="p">:</span>
                <span class="n">inp</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="n">sx</span><span class="p">,</span><span class="n">sy</span><span class="p">,</span> <span class="n">ch</span><span class="p">)</span>
                <span class="k">for</span> <span class="n">scale</span> <span class="ow">in</span> <span class="n">SCALES</span><span class="p">:</span>
                    <span class="n">ensemble</span> <span class="o">=</span> <span class="n">InferenceEnsemble</span><span class="p">(</span><span class="n">models</span><span class="p">,</span> 
                                                 <span class="n">num_classes</span><span class="o">=</span><span class="n">num_classes</span><span class="p">,</span> 
                                                 <span class="n">in_channels</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> 
                                                 <span class="n">channel_means</span><span class="o">=</span><span class="n">channel_means</span><span class="p">,</span>
                                                 <span class="n">channel_stds</span><span class="o">=</span><span class="n">channel_stds</span><span class="p">,</span> 
                                                 <span class="n">scale</span><span class="o">=</span><span class="n">scale</span><span class="p">)</span>
                    <span class="n">ensemble</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">jit</span><span class="o">.</span><span class="n">script</span><span class="p">(</span><span class="n">ensemble</span><span class="p">)</span>
                    <span class="n">outs</span> <span class="o">=</span> <span class="n">ensemble</span><span class="p">(</span><span class="n">inp</span><span class="p">)</span>
                    <span class="n">test_eq</span><span class="p">(</span><span class="n">outs</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span> <span class="p">(</span><span class="n">sx</span><span class="p">,</span> <span class="n">sy</span><span class="p">))</span>
                    <span class="n">test_eq</span><span class="p">(</span><span class="n">outs</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span> <span class="p">(</span><span class="n">num_classes</span><span class="p">,</span> <span class="n">sx</span><span class="p">,</span> <span class="n">sy</span><span class="p">))</span>
                    <span class="n">test_eq</span><span class="p">(</span><span class="n">outs</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span> <span class="p">(</span><span class="n">sx</span><span class="p">,</span> <span class="n">sy</span><span class="p">))</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">path_pt</span> <span class="o">=</span> <span class="n">Path</span><span class="p">(</span><span class="s1">&#39;ensemble.pt&#39;</span><span class="p">)</span>
<span class="n">scripted_ensemble</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">jit</span><span class="o">.</span><span class="n">script</span><span class="p">(</span><span class="n">ensemble</span><span class="p">)</span>
<span class="n">scripted_ensemble</span><span class="o">.</span><span class="n">save</span><span class="p">(</span><span class="n">path_pt</span><span class="p">)</span>
<span class="n">_</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">jit</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="n">path_pt</span><span class="p">)</span>
<span class="n">path_pt</span><span class="o">.</span><span class="n">unlink</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">if</span> <span class="n">torch</span><span class="o">.</span><span class="n">__version__</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;.&quot;</span><span class="p">)</span> <span class="o">&gt;=</span> <span class="p">[</span><span class="s2">&quot;1&quot;</span><span class="p">,</span> <span class="s2">&quot;12&quot;</span><span class="p">,</span> <span class="s2">&quot;0&quot;</span><span class="p">]:</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">torch</span><span class="o">.</span><span class="n">__version__</span><span class="p">)</span>
    <span class="n">input_names</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;inp&quot;</span><span class="p">]</span>
    <span class="n">output_names</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;argmax&quot;</span><span class="p">,</span> <span class="s2">&quot;softmax&quot;</span><span class="p">,</span> <span class="s2">&quot;stdeviation&quot;</span><span class="p">]</span>
    <span class="n">dynamic_axes</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;inp&quot;</span><span class="p">:</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="s2">&quot;argmax&quot;</span><span class="p">:</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="s2">&quot;softmax&quot;</span><span class="p">:</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">],</span> <span class="s2">&quot;stdeviation&quot;</span><span class="p">:</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">]}</span>
    <span class="n">path_onnx</span> <span class="o">=</span> <span class="n">Path</span><span class="p">(</span><span class="s1">&#39;ensemble.onnx&#39;</span><span class="p">)</span>
    <span class="n">torch</span><span class="o">.</span><span class="n">onnx</span><span class="o">.</span><span class="n">export</span><span class="p">(</span><span class="n">scripted_ensemble</span><span class="p">,</span> <span class="n">inp</span><span class="p">,</span> <span class="n">f</span><span class="o">=</span><span class="n">path_onnx</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">opset_version</span><span class="o">=</span><span class="mi">16</span><span class="p">,</span> 
                      <span class="n">input_names</span><span class="o">=</span><span class="n">input_names</span><span class="p">,</span> <span class="n">output_names</span><span class="o">=</span><span class="n">output_names</span><span class="p">,</span> <span class="n">dynamic_axes</span><span class="o">=</span><span class="n">dynamic_axes</span><span class="p">)</span>
    
    <span class="c1">#import onnxruntime</span>
    <span class="c1">#ort_session = onnxruntime.InferenceSession(path_onnx.as_posix())</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

</div>
 

